<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ ã‚«ãƒ©ãƒ•ãƒ«ãƒãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼ ğŸ¯</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-container">
        <header class="game-header">
            <h1>ğŸ¯ ã‚«ãƒ©ãƒ•ãƒ«ãƒãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼ ğŸ¯</h1>
            <div class="score-board">
                <div class="score">ã‚¹ã‚³ã‚¢: <span id="score">0</span></div>
                <div class="level">ãƒ¬ãƒ™ãƒ«: <span id="level">1</span></div>
                <div class="lines">æ¶ˆã—ãŸçƒ: <span id="lines">0</span></div>
            </div>
        </header>
        
        <div class="game-area">
            <div class="next-piece">
                <h3>æ¬¡ã®ãƒãƒ–ãƒ«</h3>
                <canvas id="next-canvas" width="60" height="60"></canvas>
            </div>
            
            <div class="game-board">
                <canvas id="game-canvas" width="400" height="380"></canvas>
                <div class="game-over" id="game-over" style="display: none;">
                    <h2>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼</h2>
                    <p>æœ€çµ‚ã‚¹ã‚³ã‚¢: <span id="final-score">0</span></p>
                    <button onclick="restartGame()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
                </div>
            </div>
            
            <div class="controls">
                <h3>æ“ä½œæ–¹æ³•</h3>
                <div class="control-buttons">
                    <button class="control-btn left-btn" onclick="rotateLeft()">â¬…ï¸</button>
                    <button class="control-btn shoot-btn" onclick="shootBubble()">ğŸ¯</button>
                    <button class="control-btn right-btn" onclick="rotateRight()">â¡ï¸</button>
                </div>
                <div class="instructions">
                    <p>ğŸ¯ åŒã˜è‰²ã‚’3ã¤ä»¥ä¸Šã¤ãªã’ã¦æ¶ˆãã†ï¼</p>
                    <small>âŒ¨ï¸ ã‚­ãƒ¼: â†â†’ ã‚¹ãƒšãƒ¼ã‚¹ | ğŸ–±ï¸ ãƒã‚¦ã‚¹: ã‚¯ãƒªãƒƒã‚¯ã§ç™ºå°„</small>
                </div>
            </div>
        </div>
    </div>
    
    <script src="game.js"></script>
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾Œã€è‡ªå‹•ã§ãƒ‡ãƒãƒƒã‚°ãƒã‚§ãƒƒã‚¯
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (window.gameDebug) {
                    const status = window.gameDebug.checkBubbles();
                    console.log('åˆæœŸçŠ¶æ…‹:', status);
                }
            }, 1000);
        });
    </script>
    <script>
        // ç°¡å˜ãªéŸ³åŠ¹æœ
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playPop() {
            // ã‚ˆã‚Šè¿«åŠ›ã®ã‚ã‚‹æ¶ˆæ»…éŸ³
            const oscillator1 = audioCtx.createOscillator();
            const oscillator2 = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator1.connect(gainNode);
            oscillator2.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            // äºŒé‡éŸ³ã§è¿«åŠ›ã‚¢ãƒƒãƒ—
            oscillator1.frequency.setValueAtTime(800, audioCtx.currentTime);
            oscillator1.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.15);
            oscillator2.frequency.setValueAtTime(1200, audioCtx.currentTime);
            oscillator2.frequency.exponentialRampToValueAtTime(400, audioCtx.currentTime + 0.15);
            
            gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.15);
            
            oscillator1.start(audioCtx.currentTime);
            oscillator2.start(audioCtx.currentTime);
            oscillator1.stop(audioCtx.currentTime + 0.15);
            oscillator2.stop(audioCtx.currentTime + 0.15);
        }
        
        function playCollision() {
            // ã‚ˆã‚Šè¿«åŠ›ã®ã‚ã‚‹è¡çªéŸ³
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            const filterNode = audioCtx.createBiquadFilter();
            
            oscillator.connect(filterNode);
            filterNode.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            // ãƒã‚¤ã‚ºçš„ãªéŸ³è‰²
            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(80, audioCtx.currentTime + 0.08);
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§éŸ³è‰²ã‚’èª¿æ•´
            filterNode.type = 'lowpass';
            filterNode.frequency.setValueAtTime(800, audioCtx.currentTime);
            filterNode.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.08);
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.08);
            
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.08);
        }
    </script>
</body>
</html>